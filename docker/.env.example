# =============================================================================
# LOBECHAT GLASSMORPHISM - KOSTENRECHNER DESIGN
# Copy this file to .env and fill in your values
# =============================================================================

# App URL
APP_URL=http://localhost:3210

# Database
POSTGRES_PASSWORD=your_secure_password_here

# Auth (Generate with: openssl rand -base64 32)
NEXT_AUTH_SECRET=your_random_secret_here
KEY_VAULTS_SECRET=your_random_secret_here

# Logto Configuration
LOGTO_ENDPOINT=http://192.168.1.240:3001
LOGTO_ADMIN_ENDPOINT=http://192.168.1.240:3002
AUTH_LOGTO_ID=your_logto_client_id
AUTH_LOGTO_SECRET=your_logto_client_secret
AUTH_LOGTO_ISSUER=http://192.168.1.240:3001/oidc

# MinIO S3 Configuration
# Struktur fuer produktionsfaehige Bildverarbeitung:
# 1) Upload nach MinIO
# 2) Presigned Preview-URL (kein public-read Bucket)
# 3) LegalChat wandelt Bild serverseitig in Base64 um
#    -> OpenRouter muss keine private URL abrufen
MINIO_ROOT_USER=admin
MINIO_ROOT_PASSWORD=your_minio_password
S3_ACCESS_KEY_ID=admin
S3_SECRET_ACCESS_KEY=your_s3_secret_key
S3_ENDPOINT=http://192.168.1.240:9000
S3_BUCKET=lobe
S3_REGION=us-east-1
S3_PUBLIC_DOMAIN=http://192.168.1.240:9000
S3_SET_ACL=0
S3_PREVIEW_URL_EXPIRE_IN=1800
S3_ENABLE_PATH_STYLE=1

# Vision + SSRF-Haertung fuer private MinIO-Instanzen
LLM_VISION_IMAGE_USE_BASE64=1
SSRF_ALLOW_PRIVATE_IP_ADDRESS=0
SSRF_ALLOW_IP_ADDRESS_LIST=192.168.1.240

# Deprecated in LegalChat, nicht mehr verwenden:
# NEXT_PUBLIC_S3_DOMAIN=

# =============================================================================
# AI PROVIDERS - OpenRouter (Primary)
# =============================================================================

# OpenRouter API Key
OPENROUTER_API_KEY=your_openrouter_api_key_here
#
# Vision/OCR Modellprofil:
# - gemini-2.5-flash-lite: Standard fuer JPEG/PNG OCR
# - gpt-5-mini: Alternative mit Vision
# - gemma-3-27b-it:free: Kostenfreier Vision-Fallback
OPENROUTER_MODEL_LIST=google/gemini-2.5-flash-lite=Gemini 2.5 Flash Lite OCR<1048576:vision:fc:reasoning:file>,openai/gpt-5-mini=GPT-5 Mini Vision<400000:vision:fc:reasoning:file>,google/gemma-3-27b-it:free=Gemma 3 27B Vision Free<131072:vision:fc:file>
DEFAULT_AGENT_CONFIG=provider=openrouter;model=google/gemini-2.5-flash-lite
# JPEG Auto-OCR: OCR immer mit Gemini 2.5 Flash Lite, Antwort weiterhin mit gewaehltem Modell
LEGALCHAT_OCR_ENABLED=1
LEGALCHAT_OCR_MODEL=google/gemini-2.5-flash-lite
LEGALCHAT_OCR_MAX_IMAGES=6
LEGALCHAT_OCR_MAX_IMAGE_BYTES=12582912
LEGALCHAT_OCR_MAX_TEXT_CHARS=12000
LEGALCHAT_OCR_TIMEOUT_MS=45000
LEGALCHAT_OCR_FILE_CACHE_TTL_MS=7200000
LEGALCHAT_OCR_S3_PRESIGN_EXPIRES_SEC=300

# Optional: Additional providers
# OPENAI_API_KEY=
# ANTHROPIC_API_KEY=
# GOOGLE_API_KEY=

# =============================================================================
# OPTIONAL: LegalChat Branding + Voice Control
# =============================================================================
LEGALCHAT_APP_NAME=LegalChat
LEGALCHAT_DEFAULT_AGENT_NAME=George
LEGALCHAT_AVATAR_URL=/custom-assets/legalchat-avatar.jpg
LEGALCHAT_FAVICON_URL=/custom-assets/legalchat-avatar.jpg
LEGALCHAT_TAB_TITLE=George · LegalChat
LEGALCHAT_ASSISTANT_ROLE_DE=persönlicher KI-Jurist
LEGALCHAT_ASSISTANT_ROLE_EN=personal AI legal assistant
# guarded = Guardrails aktiv, off = Voice/Mic komplett deaktiviert
LEGALCHAT_VOICE_MODE=off
LEGALCHAT_STT_MAX_RECORDING_MS=90000
LEGALCHAT_STT_SILENCE_STOP_MS=3000
#
# Logout-Verhalten:
# - local: kein sichtbarer Logto-Logout-Screen (nur lokale Session wird beendet)
# - oidc: RP-initiated OIDC Logout bei Logto
LEGALCHAT_LOGOUT_MODE=local
LEGALCHAT_LOCAL_LOGOUT_REDIRECT_URL=/login?logged_out=1
# Erzwingt echte Login-Maske bei jeder Anmeldung (statt stilles SSO-Reuse)
LEGALCHAT_FORCE_LOGIN_PROMPT=1
# Branding für gehostete Logto-Anmeldeseite (auth.legalchat.net)
LEGALCHAT_LOGTO_BRANDING=1
LEGALCHAT_LOGTO_BRANDING_HOSTS=auth.legalchat.net
LEGALCHAT_PUBLIC_ASSET_BASE=https://legalchat.net
LEGALCHAT_LOGTO_LOGO_URL=https://legalchat.net/custom-assets/legalchat-avatar.jpg
LOGTO_UPSTREAM_HOST=logto
LOGTO_UPSTREAM_PORT=3001
LOGTO_END_SESSION_ENDPOINT=https://auth.legalchat.net/oidc/session/end
LOGTO_POST_LOGOUT_REDIRECT_URL=https://legalchat.net

# =============================================================================
# OPTIONAL: Internal MCP lane (George deep research / pruefungsmodus)
# =============================================================================
# Keep MCPs private. Do NOT publish MCP ports publicly.
LEGALCHAT_MCP_INTERNAL_ENABLED=1
LEGALCHAT_MCP_DEEP_RESEARCH_ENDPOINT=http://mcp-zivilrecht:8070
LEGALCHAT_MCP_PRUEFUNGSMODUS_ENDPOINT=http://mcp-zivil-pruefung:8071
# Optionaler Bearer-Token fuer externe, autorisierte Service-Calls
# (intern im Browser-Flow nicht noetig, da Session-Cookies verwendet werden)
LEGALCHAT_MCP_BEARER_TOKEN=
# Optional: separater Admin-Bearer fuer privilegierte Tools
# (wenn leer, muessen privilegierte Tools ueber Admin-Session laufen)
LEGALCHAT_MCP_ADMIN_BEARER_TOKEN=
# Timeouts fuer MCP-Proxy-Aufrufe (ms)
LEGALCHAT_MCP_REQUEST_TIMEOUT_MS=1200000
LEGALCHAT_MCP_STATUS_TIMEOUT_MS=3000
MCP_ZIVILRECHT_CODE_PATH=/opt/legalchat/mcp/zivilrecht
MCP_ZIVIL_PRUEFUNG_CODE_PATH=/opt/legalchat/mcp/zivil-pruefung
MCP_RULESETS_PATH=/opt/legalchat/mcp/rulesets
SUPER_RIS_POSTGRES_DB=super_ris
SUPER_RIS_POSTGRES_USER=postgres
SUPER_RIS_POSTGRES_PASSWORD=CHANGE_ME_STRONG_SECRET
MCP_ZIVILRECHT_DB_HOST=mcp-super-ris-postgres
MCP_ZIVILRECHT_DB_PORT=5432
MCP_ZIVILRECHT_DB_NAME=super_ris
MCP_ZIVILRECHT_DB_USER=postgres
MCP_ZIVILRECHT_DB_PASSWORD=CHANGE_ME_STRONG_SECRET
MCP_ZIVILRECHT_DB_CONNECT_TIMEOUT=10
MCP_ZIVILRECHT_DB_SSLMODE=disable
MCP_SUPER_RIS_ARTIFACTS_HOST_PATH=./mcp-super-ris-artifacts
MCP_SUPER_RIS_IMPORT_JSON_ROOT=/srv/super-ris-artifacts
MCP_SUPER_RIS_IMPORT_JSON_GLOB=*_TE.json
MCP_SUPER_RIS_IMPORT_HTML_ROOTS=/srv/super-ris-artifacts
MCP_SUPER_RIS_IMPORT_COMMIT_EVERY=1000
MCP_SUPER_RIS_IMPORT_RS_JSON_ROOT=/srv/super-ris-artifacts
MCP_SUPER_RIS_IMPORT_RS_JSON_GLOB=*_RS.json
MCP_SUPER_RIS_IMPORT_RS_COMMIT_EVERY=1000
MCP_STDOUT_SAFE_PATCH=1
MCP_ZIVILRECHT_COMMAND=python3 /srv/mcp/mcp_server_zivilrecht.py
MCP_ZIVIL_PRUEFUNG_COMMAND=python3 /srv/mcp/mcp_server_zivil_pruefung.py
MCP_BRIDGE_STDIO_PROTOCOL=jsonl
MCP_PROTOCOL_VERSION=2024-11-05
MCP_BRIDGE_INIT_TIMEOUT_SEC=45
MCP_BRIDGE_REQUEST_TIMEOUT_SEC=1200
# Kommagetrennte Liste fuer privilegierte MCP-Tools
# (nur fuer Admin-E-Mails / Admin-Rollen / LEGALCHAT_MCP_ADMIN_BEARER_TOKEN)
LEGALCHAT_MCP_ADMIN_EMAILS=
LEGALCHAT_MCP_ADMIN_ROLES=admin,owner,superadmin
LEGALCHAT_MCP_PRIVILEGED_TOOLS_DEEP_RESEARCH=ask_gemini_zivilrecht
LEGALCHAT_MCP_PRIVILEGED_TOOLS_PRUEFUNGSMODUS=run_exam,run_cct,get_validation_dashboard
